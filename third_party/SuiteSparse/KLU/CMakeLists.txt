cmake_minimum_required (VERSION 2.8.6) 
PROJECT (KLU C)

SET(PROJECT_DEPENDENCIES AMD BTF COLAMD)
SET(BASE_DEPENDENCY SuiteSparse_config)

SET(PROJECT_INCLUDE_DIRS ../${BASE_DEPENDENCY})
LIST(APPEND PROJECT_INCLUDE_DIRS Include)

FOREACH(PROJECT_DEPENDENCY ${PROJECT_DEPENDENCIES})
  LIST(APPEND PROJECT_INCLUDE_DIRS ../${PROJECT_DEPENDENCY}/Include)
ENDFOREACH(PROJECT_DEPENDENCY)


FILE(GLOB C_SOURCES Source/*.c)
FILE(GLOB C_HEADERS Include/*.h)

FILE(GLOB BASE_SOURCES ${BASE_DEPENDENCY}/*.c)
LIST(APPEND C_SOURCES ${BASE_SOURCES})

FILE(GLOB BASE_HEADERS ${BASE_DEPENDENCY}/*.h)
LIST(APPEND C_HEADERS ${BASE_SOURCES})

FOREACH(PROJECT_DEPENDENCY ${PROJECT_DEPENDENCIES})
  FILE(GLOB X_SOURCES ../${PROJECT_DEPENDENCY}/Source/*.c)
  LIST(APPEND C_SOURCES ${X_SOURCES})
  FILE(GLOB X_HEADERS ../${PROJECT_DEPENDENCY}/Include/*.h)
  LIST(APPEND C_HEADERS ${X_HEADERS})
ENDFOREACH(PROJECT_DEPENDENCY)

INCLUDE_DIRECTORIES(${PROJECT_INCLUDE_DIRS})
MESSAGE(${C_SOURCES})

ADD_LIBRARY(KLU STATIC ${C_SOURCES} ${C_HEADERS})

ADD_EXECUTABLE(klu_simple Demo/klu_simple.c)
TARGET_LINK_LIBRARIES(klu_simple KLU)